{# @var this \App\McpInstances\Presentation\Components\HealthOverviewComponent #}
<div {{ attributes }} data-poll="delay(2000)|$render">
    {% set status = this.getStatus() %}
    {% set all = status.allRunning %}
    <div class="etfswui-card mb-8 text-left">
        <div class="etfswui-card-title flex items-center justify-between">
            <span class="etfswui-card-title-text">Instance Health Status</span>
            <div class="flex items-center gap-3">
                {% if all %}
                    <span class="etfswui-badge etfswui-badge-success">All Systems Operational</span>
                {% else %}
                    <span class="etfswui-badge etfswui-badge-warning">Some Issues Detected</span>
                {% endif %}
            </div>
        </div>
        <div class="etfswui-card-content">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                {% set p = status.processes %}
                {# Xvfb #}
                <div class="flex items-center justify-between p-4 rounded-md border {{ p.xvfb ? 'bg-green-50 dark:bg-green-900/10 border-green-200 dark:border-green-800' : 'bg-red-50 dark:bg-red-900/10 border-red-200 dark:border-red-800' }}">
                    <div class="flex items-center gap-3">
                        <div class="w-3 h-3 rounded-full {{ p.xvfb ? 'bg-green-500' : 'bg-red-500' }}"></div>
                        <div>
                            <div class="font-semibold text-sm">Virtual Display</div>
                            <div class="text-xs text-dark-500 dark:text-dark-400">Xvfb</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="etfswui-badge {{ p.xvfb ? 'etfswui-badge-success' : 'etfswui-badge-error' }} text-xs">{{ p.xvfb ? 'Running' : 'Stopped' }}</span>
                    </div>
                </div>

                {# MCP #}
                <div class="flex items-center justify-between p-4 rounded-md border {{ p.mcp ? 'bg-green-50 dark:bg-green-900/10 border-green-200 dark:border-green-800' : 'bg-red-50 dark:bg-red-900/10 border-red-200 dark:border-red-800' }}">
                    <div class="flex items-center gap-3">
                        <div class="w-3 h-3 rounded-full {{ p.mcp ? 'bg-green-500' : 'bg-red-500' }}"></div>
                        <div>
                            <div class="font-semibold text-sm">Playwright MCP</div>
                            <div class="text-xs text-dark-500 dark:text-dark-400">{{ status.containerStatus.mcpEndpoint }}</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="etfswui-badge {{ p.mcp ? 'etfswui-badge-success' : 'etfswui-badge-error' }} text-xs">{{ p.mcp ? 'Running' : 'Stopped' }}</span>
                    </div>
                </div>

                {# VNC #}
                <div class="flex items-center justify-between p-4 rounded-md border {{ p.vnc ? 'bg-green-50 dark:bg-green-900/10 border-green-200 dark:border-green-800' : 'bg-red-50 dark:bg-red-900/10 border-red-200 dark:border-red-800' }}">
                    <div class="flex items-center gap-3">
                        <div class="w-3 h-3 rounded-full {{ p.vnc ? 'bg-green-500' : 'bg-red-500' }}"></div>
                        <div>
                            <div class="font-semibold text-sm">VNC Server</div>
                            <div class="text-xs text-dark-500 dark:text-dark-400">{{ status.containerStatus.vncEndpoint }}</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="etfswui-badge {{ p.vnc ? 'etfswui-badge-success' : 'etfswui-badge-error' }} text-xs">{{ p.vnc ? 'Running' : 'Stopped' }}</span>
                    </div>
                </div>

                {# Websocket #}
                <div class="flex items-center justify-between p-4 rounded-md border {{ p.websocket ? 'bg-green-50 dark:bg-green-900/10 border-green-200 dark:border-green-800' : 'bg-red-50 dark:bg-red-900/10 border-red-200 dark:border-red-800' }}">
                    <div class="flex items-center gap-3">
                        <div class="w-3 h-3 rounded-full {{ p.websocket ? 'bg-green-500' : 'bg-red-500' }}"></div>
                        <div>
                            <div class="font-semibold text-sm">VNC Web Client</div>
                            <div class="text-xs text-dark-500 dark:text-dark-400">noVNC/websockify</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="etfswui-badge {{ p.websocket ? 'etfswui-badge-success' : 'etfswui-badge-error' }} text-xs">{{ p.websocket ? 'Running' : 'Stopped' }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


